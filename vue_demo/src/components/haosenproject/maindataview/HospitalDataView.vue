<template>  <div class="hospital-data-view">    <!-- 整合的搜索和数据区域 -->    <div class="integrated-container">      <!-- 搜索区域 -->      <div class="fixed-search">        <el-form :inline="true" :model="searchForm" class="search-form" @submit.prevent="handleSearch">          <el-form-item label="原始编码">            <el-input v-model="searchForm.dataCode" placeholder="请输入原始编码" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="原始名称">            <el-input v-model="searchForm.originalName" placeholder="请输入原始名称" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="DataId">            <el-input v-model="searchForm.dataId" placeholder="请输入DataId" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="KeyId">            <el-input v-model="searchForm.keyid" placeholder="请输入KeyId" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="豪森编码">            <el-input v-model="searchForm.hsCode" placeholder="请输入清洗后的编码" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="省份">            <el-input v-model="searchForm.province" placeholder="请输入省份" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="市">            <el-input v-model="searchForm.city" placeholder="请输入市" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="区县">            <el-input v-model="searchForm.area" placeholder="请输入区县" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="医院名称">            <el-input v-model="searchForm.name" placeholder="请输入医院名称" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item label="医院地址">            <el-input v-model="searchForm.address" placeholder="请输入医院地址" clearable @clear="handleSearch" @keyup.enter="handleSearch" />          </el-form-item>          <el-form-item class="form-actions">            <el-button type="primary" @click="handleSearch" :loading="loading">查询</el-button>            <el-button @click="resetSearch">重置</el-button>            <el-button type="success" @click="toExcel" :loading="exporting">              {{ exporting ? '导出中...' : '导出' }}            </el-button>            <!-- 视图切换按钮 -->            <el-button-group class="view-toggle">              <el-button                  :type="viewMode === 'table' ? 'primary' : 'default'"                  size="small"                  @click="viewMode = 'table'"                  title="表格视图"              >                <el-icon><Grid /></el-icon>              </el-button>              <el-button                  :type="viewMode === 'card' ? 'primary' : 'default'"                  size="small"                  @click="viewMode = 'card'"                  title="卡片视图"              >                <el-icon><CopyDocument /></el-icon>              </el-button>            </el-button-group>          </el-form-item>        </el-form>      </div>      <!-- 数据区域 -->      <div class="data-content">        <div class="content-wrapper" v-loading="loading">          <!-- 表格视图 -->          <div v-if="viewMode === 'table'" class="table-view">            <el-table                v-if="hospitalData.list?.length"                :data="hospitalData.list"                height="100%"                stripe                border                fit            >              <el-table-column                  v-for="(col, index) in columns"                  :key="index"                  :prop="col.prop"                  :label="col.label"                  :width="col.width"                  :fixed="col.fixed"                  show-overflow-tooltip              >                <template #header>                  <div class="th-content">                    {{ col.label }}                    <div class="resize-handle" @mousedown.stop="startResize($event, index)"></div>                  </div>                </template>                <template #default="{ row }">                  <template v-if="index === 0">                    <el-link type="primary" :underline="false" @click="copyText(row.dataId)" :disabled="!row.dataId">                      {{ row.dataId }}                    </el-link>                  </template>                  <template v-else-if="index === 1">                    <el-link type="primary" :underline="false" @click="copyText(row.dataCode)">                      {{ row.dataCode }}                    </el-link>                  </template>                  <template v-else-if="index === 2">                    <el-link type="primary" :underline="false" @click="copyText(row.originalName)">                      {{ row.originalName }}                    </el-link>                  </template>                  <template v-else-if="index === 3">                    <el-link type="primary" :underline="false" @click="copyText(row.keyid)">                      {{ row.keyid }}                    </el-link>                  </template>                  <template v-else-if="index === 4">                    <el-link type="primary" :underline="false" @click="copyText(row.name)">                      {{ row.name }}                    </el-link>                  </template>                  <template v-else-if="index === 5">{{ row.province }}</template>                  <template v-else-if="index === 6">{{ row.city }}</template>                  <template v-else-if="index === 7">{{ row.area }}</template>                  <template v-else-if="index === 8">{{ row.address }}</template>                  <template v-else-if="index === 9">                    <el-tag :type="getStatusType(row.status)" effect="dark" size="small">                      {{ getStatusText(row.status) }}                    </el-tag>                  </template>                  <template v-else-if="index === 10">                    <el-button type="success" size="small" @click="showDetail(row)">详情</el-button>                    <el-button type="primary" size="small" :disabled="!row.hsCode" @click="updateDetail(row)">更新</el-button>                  </template>                </template>              </el-table-column>            </el-table>            <div v-else class="no-data-container">              <el-empty description="没有找到匹配的医院数据" :image-size="120" />            </div>          </div>          <!-- 卡片视图 -->          <div v-else class="card-view">            <el-empty v-if="!hospitalData.list?.length" description="没有找到匹配的医院数据" class="no-data-container" />            <el-row :gutter="20" v-else>              <el-col v-for="hospital in hospitalData.list" :key="hospital.dataId" :xs="24" :sm="12" :md="8" :lg="6" :xl="4">                <el-card class="hospital-card" shadow="hover">                  <template #header>                    <div class="card-header">                      <div class="card-title">                        <el-link type="primary" :underline="false" @click="copyText(hospital.name)">                          {{ hospital.name }}                        </el-link>                      </div>                      <el-tag :type="getStatusType(hospital.status)" size="small" effect="dark">                        {{ getStatusText(hospital.status) }}                      </el-tag>                    </div>                  </template>                  <div class="card-body">                    <div class="card-item"><span class="label">dataId：</span><el-link type="primary" :underline="false" @click="copyText(hospital.dataId)">{{ hospital.dataId }}</el-link></div>                    <div class="card-item"><span class="label">原始编码：</span><el-link type="primary" :underline="false" @click="copyText(hospital.dataCode)">{{ hospital.dataCode }}</el-link></div>                    <div class="card-item"><span class="label">原始名称：</span><el-link type="primary" :underline="false" @click="copyText(hospital.originalName)">{{ hospital.originalName }}</el-link></div>                    <div class="card-item"><span class="label">keyId：</span><el-link type="primary" :underline="false" @click="copyText(hospital.keyid)">{{ hospital.keyid }}</el-link></div>                    <div class="card-item"><span class="label">省份：</span>{{ hospital.province }}</div>                    <div class="card-item"><span class="label">城市：</span>{{ hospital.city }}</div>                    <div class="card-item"><span class="label">区县：</span>{{ hospital.area }}</div>                    <div class="card-item"><span class="label">地址：</span>{{ hospital.address }}</div>                  </div>                  <div class="card-footer">                    <el-button type="success" size="small" @click="showDetail(hospital)">详情</el-button>                    <el-button type="primary" size="small" :disabled="!hospital.hsCode" @click="updateDetail(hospital)">更新</el-button>                  </div>                </el-card>              </el-col>            </el-row>          </div>        </div>        <!-- 分页 -->        <div class="fixed-pagination" v-if="hospitalData.list?.length">          <div class="pagination-content">            <el-button size="small" plain :disabled="!hospitalData.hasPreviousPage" @click="pageNumber > 1 && (pageNumber--, fetchHospitalData())">              上一页            </el-button>            <span class="page-info">              第 {{ hospitalData.pageNum }} 页 / 共 {{ hospitalData.pages }} 页 (共 {{ hospitalData.total }} 条)            </span>            <el-button size="small" plain :disabled="!hospitalData.hasNextPage" @click="pageNumber < hospitalData.pages && (pageNumber++, fetchHospitalData())">              下一页            </el-button>            <el-select v-model="pageSize" size="small" style="width: 110px;" @change="handlePageSizeChange">              <el-option :value="20" label="每页20条" />              <el-option :value="40" label="每页40条" />              <el-option :value="60" label="每页60条" />            </el-select>          </div>        </div>      </div>    </div>    <!-- 详情弹窗 -->    <el-dialog v-model="showDetailModal" title="医院详情" width="500px" destroy-on-close>      <template #title>        <div class="custom-dialog-title">医院详情</div>      </template>      <div class="detail-container">        <div class="detail-row" v-for="(item, key) in detailFields" :key="key">          <label>{{ item.label }}：</label>          <span>            <template v-if="item.copy">              <el-link type="primary" :underline="false" @click="copyText(item.value(currentHospital))">                {{ item.value(currentHospital) }}              </el-link>            </template>            <template v-else-if="key === 'status'">              <!-- 对status字段特殊处理，显示带样式的tag -->              <el-tag :type="item.type(currentHospital)" size="small" effect="dark" style="color: #fff;">                {{ item.value(currentHospital) }}              </el-tag>            </template>            <template v-else>              {{ item.value(currentHospital) }}            </template>          </span>        </div>      </div>      <template #footer>        <el-button @click="showDetailModal = false">关闭</el-button>      </template>    </el-dialog>    <!-- 更新弹窗：标题居中 + 顶部按钮靠右 + 内容上下滚动 -->    <el-dialog        v-model="updateDetailModal"        width="70%"        :max-width="1400"        :close-on-click-modal="false"        destroy-on-close        class="update-dialog"    >      <!-- 自定义标题：居中显示 -->      <template #title>        <div class="custom-dialog-title">数据更新</div>      </template>      <!-- 顶部固定操作栏：按钮靠右 -->      <div class="dialog-fixed-header">        <div class="header-actions">          <el-button @click="resetForm">重置匹配</el-button>          <el-button type="primary" :loading="isFinding" @click="findDaKuData">            {{ isFinding ? '匹配中...' : '匹配大库' }}          </el-button>          <el-button type="primary" :loading="isSaving" @click="saveChanges">            {{ isSaving ? '推送中...' : '提交推送' }}          </el-button>          <el-button @click="closeUpdateModal">取消</el-button>        </div>      </div>      <!-- 可上下滚动的表单内容区 -->      <div class="dialog-scroll-body">        <el-form :model="currentUpdateHospital" label-width="140px">          <el-row :gutter="30">            <el-col :span="12">              <el-form-item label="批次编号"><el-input v-model="currentUpdateHospital.batchCode" readonly /></el-form-item>              <el-form-item label="dataId"><el-input v-model="currentUpdateHospital.dataId" readonly /></el-form-item>              <el-form-item label="原始名称"><el-input v-model="currentUpdateHospital.originalName" readonly /></el-form-item>              <el-form-item label="数据类型">                <el-input :value="currentUpdateHospital.dataType === '1' ? '存量' : currentUpdateHospital.dataType === '2' ? '增量' : '未知'" readonly />              </el-form-item>              <el-form-item label="原始编码"><el-input v-model="currentUpdateHospital.dataCode" readonly /></el-form-item>              <el-form-item label="原始省份"><el-input v-model="currentUpdateHospital.originalProvince" readonly /></el-form-item>              <el-form-item label="经销商"><el-input v-model="currentUpdateHospital.companyName" readonly /></el-form-item>            </el-col>            <el-col :span="12">              <!-- 右侧所有表单项保持原样 -->              <el-form-item label="机构类型">                <el-select v-model="currentUpdateHospital.orgType">                  <el-option label="医院" value="医院" />                  <el-option label="药店" value="药店" />                  <el-option label="商业" value="商业" />                </el-select>              </el-form-item>              <el-form-item label="keyId"><el-input v-model="currentUpdateHospital.keyid" /></el-form-item>              <el-form-item label="标准名称"><el-input v-model="currentUpdateHospital.name" /></el-form-item>              <el-form-item label="历史名称"><el-input v-model="currentUpdateHospital.nameHistory" /></el-form-item>              <el-form-item label="省"><el-input v-model="currentUpdateHospital.province" /></el-form-item>              <el-form-item label="省ID"><el-input v-model="currentUpdateHospital.provinceId" /></el-form-item>              <el-form-item label="市"><el-input v-model="currentUpdateHospital.city" /></el-form-item>              <el-form-item label="市ID"><el-input v-model="currentUpdateHospital.cityId" /></el-form-item>              <el-form-item label="区县"><el-input v-model="currentUpdateHospital.area" /></el-form-item>              <el-form-item label="区县ID"><el-input v-model="currentUpdateHospital.areaId" /></el-form-item>              <el-form-item label="地址"><el-input v-model="currentUpdateHospital.address" /></el-form-item>              <el-form-item label="等级">                <el-select v-model="currentUpdateHospital.level">                  <el-option label="未定级" value="未定级" />                  <el-option label="一级" value="一级" />                  <el-option label="二级" value="二级" />                  <el-option label="三级" value="三级" />                </el-select>              </el-form-item>              <el-form-item label="等次">                <el-select v-model="currentUpdateHospital.grade">                  <el-option label="未定等" value="未定等" />                  <el-option label="甲等" value="甲等" />                  <el-option label="乙等" value="乙等" />                  <el-option label="丙等" value="丙等" />                </el-select>              </el-form-item>              <el-form-item label="所有制">                <el-select v-model="currentUpdateHospital.publicflag">                  <el-option label="公立" value="公立" />                  <el-option label="民营" value="民营" />                </el-select>              </el-form-item>              <el-form-item label="类别"><el-input v-model="currentUpdateHospital.classify" /></el-form-item>              <el-form-item label="总分院kid"><el-input v-model="currentUpdateHospital.generalBranchKid" /></el-form-item>              <el-form-item label="总分院名称"><el-input v-model="currentUpdateHospital.generalBranchName" /></el-form-item>              <el-form-item label="是否军队医院">                <el-select v-model="currentUpdateHospital.militaryHos">                  <el-option label="是" value="1" />                  <el-option label="否" value="0" />                </el-select>              </el-form-item>              <el-form-item label="登记号"><el-input v-model="currentUpdateHospital.regcode" /></el-form-item>              <el-form-item label="有效期"><el-input v-model="currentUpdateHospital.validity" /></el-form-item>              <el-form-item label="诊疗科室"><el-input v-model="currentUpdateHospital.subjects" /></el-form-item>              <el-form-item label="法人代表"><el-input v-model="currentUpdateHospital.legalperson" /></el-form-item>              <el-form-item label="统一社会信用代码"><el-input v-model="currentUpdateHospital.usci" /></el-form-item>              <el-form-item label="经营方式">                <el-select v-model="currentUpdateHospital.operation">                  <el-option label="零售" value="零售" />                  <el-option label="批发" value="批发" />                  <el-option label="连锁" value="连锁" />                </el-select>              </el-form-item>              <el-form-item label="经营范围"><el-input v-model="currentUpdateHospital.scope" /></el-form-item>              <el-form-item label="总分店kid"><el-input v-model="currentUpdateHospital.mainBranchKid" /></el-form-item>              <el-form-item label="总分店名称"><el-input v-model="currentUpdateHospital.mainBranchName" /></el-form-item>              <el-form-item label="成立日期"><el-input v-model="currentUpdateHospital.createDate" /></el-form-item>              <el-form-item label="注册资金"><el-input v-model="currentUpdateHospital.registCapi" /></el-form-item>              <el-form-item label="企业类型"><el-input v-model="currentUpdateHospital.econKind" /></el-form-item>              <el-form-item label="登记状态"><el-input v-model="currentUpdateHospital.signStatus" /></el-form-item>              <el-form-item label="所属行业"><el-input v-model="currentUpdateHospital.industry" /></el-form-item>              <el-form-item label="登记机关"><el-input v-model="currentUpdateHospital.belong" /></el-form-item>            </el-col>          </el-row>        </el-form>      </div>    </el-dialog>  </div></template><script setup>import '@/assets/css/dark-mode.css'import { ref, reactive, onMounted } from 'vue'import { Grid, CopyDocument } from '@element-plus/icons-vue'import axios from 'axios'import { ElMessage, ElMessageBox } from 'element-plus'// 视图模式：table 或 card，默认表格const viewMode = ref('table')const hospitalData = reactive({  list: [],  total: 0,  pages: 0,  pageNum: 1,  hasNextPage: false,  hasPreviousPage: false})const loading = ref(false)const exporting = ref(false)const pageSize = ref(20)const pageNumber = ref(1)const searchForm = reactive({  dataCode: '',  originalName: '',  dataId: '',  keyid: '',  hsCode: '',  province: '',  city: '',  area: '',  name: '',  address: ''})const columns = ref([  { label: 'dataId', prop: 'dataId' },  { label: '原始编码', prop: 'dataCode' },  { label: '原始名称', prop: 'originalName'},  { label: 'keyId', prop: 'keyid' },  { label: '标准名称', prop: 'name'},  { label: '省份', prop: 'province'},  { label: '城市', prop: 'city' },  { label: '区县', prop: 'area' },  { label: '地址', prop: 'address' },  { label: '状态', prop: 'status' },  { label: '操作', fixed: 'right' , width: 140}])const showDetailModal = ref(false)const updateDetailModal = ref(false)const currentHospital = ref({})const originalHospital = ref({})const currentUpdateHospital = ref({})const isSaving = ref(false)const isFinding = ref(false)const detailFields = {  batchCode: { label: '批次编号', value: h => h.batchCode, copy: true },  dataId: { label: 'dataId', value: h => h.dataId, copy: true },  dataCode: { label: '原始编码', value: h => h.dataCode, copy: true },  originalName: { label: '原始名称', value: h => h.originalName, copy: true },  originalProvince: { label: '原始省份', value: h => h.originalProvince },  companyName: { label: '经销商', value: h => h.companyName },  keyid: { label: 'keyId', value: h => h.keyid, copy: true },  dataType: { label: '数据类型', value: h => h.dataType === '1' ? '存量' : h.dataType === '2' ? '增量' : '未知' },  hsCode: { label: '豪森清洗后编码', value: h => h.hsCode, copy: true },  name: { label: '标准名称', value: h => h.name, copy: true },  nameHistory: { label: '历史名称', value: h => h.nameHistory },  province: { label: '省份', value: h => h.province },  provinceId: { label: '省份ID', value: h => h.provinceId },  city: { label: '市', value: h => h.city },  cityId: { label: '市ID', value: h => h.cityId },  area: { label: '区县', value: h => h.area },  areaId: { label: '区县ID', value: h => h.areaId },  address: { label: '地址', value: h => h.address },  usci: { label: '统一社会信用代码', value: h => h.usci },  level: { label: '等级', value: h => h.level },  grade: { label: '等次', value: h => h.grade },  publicflag: { label: '所有制', value: h => h.publicflag },  hosClass: { label: '豪森医院类型', value: h => h.hosClass },  hosBigClass: { label: '豪森医院大类', value: h => h.hosBigClass },  class1: { label: '一级属性', value: h => h.class1 },  class2: { label: '二级属性', value: h => h.class2 },  class3: { label: '三级属性', value: h => h.class3 },  class4: { label: '四级属性', value: h => h.class4 },  classify: { label: '五级属性', value: h => h.classify },  militaryHos: {    label: '是否军队医院',    value: h => (h.militaryHos === '1' ? '是' : h.militaryHos === '0' ? '否' : '未知')  },  internetHos: { label: '是否互联网医院', value: h => h.internetHos },  medUnionCommunity: { label: '医联体/医共体', value: h => h.medUnionCommunity },  ybcode: { label: '医保编码', value: h => h.ybcode },  regcode: { label: '登记号', value: h => h.regcode },  validity: { label: '许可证有效期', value: h => h.validity },  menzhen: { label: '是否门诊统筹', value: h => h.menzhen },  bedCount: { label: '床位数目', value: h => h.bedCount },  medicalCount: { label: '医护人数', value: h => h.medicalCount },  subjects: { label: '诊疗科目', value: h => h.subjects },  legalperson: { label: '法人', value: h => h.legalperson },  isInsert: { label: '是否新增', value: h => h.isInsert },  repeatId: { label: '豪森重复数据ID', value: h => h.repeatId },  generalBranch: { label: '上级单位豪森编码', value: h => h.generalBranch },  generalBranchKid: { label: '上级单位KeyId', value: h => h.generalBranchKid },  generalBranchName: { label: '上级单位名称', value: h => h.generalBranchName },  internetHosclassify: { label: '互联网医院类别', value: h => h.internetHosclassify },  field1: { label: '经纬度', value: h => h.field1 },  remarks: { label: '备注', value: h => h.remarks },  addtime: { label: '添加日期', value: h => h.addtime },  updatetime: { label: '更新日期', value: h => h.updatetime },  status: {    label: '状态',    value: h => getStatusText(h.status),    type: h => getStatusType(h.status)  }}const getStatusText = (status) => {  const map = { '1': '清洗成功', '2': '数据作废', '3': '无法清洗', '4': '禁用客户', '5': '数据重复' }  return map[status] || '其他状态'}const getStatusType = (status) => {  const map = { '1': 'success', '2': 'warning', '3': 'info', '4': 'danger', '5': 'warning' }  return map[status] || 'info'}const fetchHospitalData = async () => {  loading.value = true  try {    const params = { pageNum: pageNumber.value, pageSize: pageSize.value, ...searchForm }    const { data } = await axios.get('/api/mainData/getHospitalData', { params })    if (data.code === 200) {      Object.assign(hospitalData, data.data)      pageNumber.value = data.data.pageNum    } else {      ElMessage.error(data.msg || '获取数据失败')    }  } catch {    ElMessage.error('网络请求异常')  } finally {    loading.value = false  }}const handleSearch = () => {  pageNumber.value = 1  fetchHospitalData()}const resetSearch = () => {  Object.keys(searchForm).forEach(key => (searchForm[key] = ''))  pageNumber.value = 1  fetchHospitalData()}const handlePageSizeChange = () => {  pageNumber.value = 1  fetchHospitalData()}const copyText = async (text) => {  if (!text) return  try {    await navigator.clipboard.writeText(text)    ElMessage.success('已复制')  } catch {    ElMessage.error('复制失败')  }}const toExcel = async () => {  if (exporting.value) return  exporting.value = true  try {    const params = { ...searchForm }    const { data: jsonBlob } = await axios.get('/api/mainData/exportHospitalData', { params, responseType: 'blob' })    const jsonText = await jsonBlob.text()    const { data: base64 } = JSON.parse(jsonText)    const byteChars = atob(base64)    const byteNums = new Uint8Array(byteChars.length)    for (let i = 0; i < byteChars.length; i++) byteNums[i] = byteChars.charCodeAt(i)    const excelBlob = new Blob([byteNums], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' })    const url = URL.createObjectURL(excelBlob)    const link = document.createElement('a')    link.href = url    link.download = `豪森医疗机构数据导出_${new Date().toLocaleDateString()}.xlsx`    link.click()    URL.revokeObjectURL(url)  } catch {    ElMessage.error('导出失败')  } finally {    exporting.value = false  }}const showDetail = (row) => {  currentHospital.value = { ...row }  showDetailModal.value = true}const updateDetail = (row) => {  originalHospital.value = JSON.parse(JSON.stringify(row))  currentUpdateHospital.value = JSON.parse(JSON.stringify(row))  updateDetailModal.value = true}const closeUpdateModal = () => {  updateDetailModal.value = false  currentUpdateHospital.value = {}  originalHospital.value = {}}const saveChanges = async () => {  if (isSaving.value) return  isSaving.value = true  try {    const { data } = await axios.post('/api/updateData/OneUpdateHaoSenData', currentUpdateHospital.value)    if (data.code === 200) {      ElMessage.success('提交更新成功')      closeUpdateModal()      fetchHospitalData()    } else {      ElMessage.error(data.msg || '提交失败')    }  } catch {    ElMessage.error('网络异常')  } finally {    isSaving.value = false  }}const findDaKuData = async () => {  if (isFinding.value) return  if (!currentUpdateHospital.value.keyid) {    ElMessage.warning('请先输入keyid')    return  }  isFinding.value = true  try {    const { data } = await axios.get('/api/updateData/findDaKuData', { params: { keyid: currentUpdateHospital.value.keyid } })    if (data.code === 200 && data.data) {      // 先保存原始不可编辑字段      const protectedFields = {        batchCode: currentUpdateHospital.value.batchCode,        dataId: currentUpdateHospital.value.dataId,        dataType: currentUpdateHospital.value.dataType,        dataCode: currentUpdateHospital.value.dataCode,        originalName: currentUpdateHospital.value.originalName,        originalProvince: currentUpdateHospital.value.originalProvince,        companyName: currentUpdateHospital.value.companyName,      }      // 更新其他字段      Object.assign(currentUpdateHospital.value, data.data)      // 强制恢复原始字段（防止被大库数据覆盖）      Object.assign(currentUpdateHospital.value, protectedFields)      ElMessage.success('匹配成功，已填充')    } else {      ElMessage.error('未找到匹配数据')    }  } catch {    ElMessage.error('匹配失败')  } finally {    isFinding.value = false  }}const resetForm = () => {  ElMessageBox.confirm('确定要重置所有修改吗？重置后将恢复为原始数据。', '确认重置', { type: 'warning' })      .then(() => {        currentUpdateHospital.value = JSON.parse(JSON.stringify(originalHospital.value))        ElMessage.success('已重置为原始数据')      })}// 列宽拖拽（仅表格视图有效）const resizing = ref(false)const resizeColumnIndex = ref(null)const startX = ref(0)const startWidth = ref(0)const startResize = (e, index) => {  resizing.value = true  resizeColumnIndex.value = index  startX.value = e.clientX  startWidth.value = columns.value[index].width  document.addEventListener('mousemove', handleResize)  document.addEventListener('mouseup', stopResize)}const handleResize = (e) => {  if (!resizing.value) return  const dx = e.clientX - startX.value  const newWidth = Math.max(80, Math.min(600, startWidth.value + dx))  columns.value[resizeColumnIndex.value].width = newWidth}const stopResize = () => {  resizing.value = false  document.removeEventListener('mousemove', handleResize)  document.removeEventListener('mouseup', stopResize)}onMounted(() => {  fetchHospitalData()})</script><style scoped>.hospital-data-view {  display: flex;  flex-direction: column;  height: 100vh;  max-width: min(1250px, 95vw);  margin: 0 auto;  background: white;  overflow: hidden;  font-size: 12px;}/* 整合的整体容器 */.integrated-container {  flex: 1;  display: flex;  flex-direction: column;  height: 100%;  overflow: hidden;  margin: 8px;  border: 1px solid #ebeef5;  border-radius: 6px;  background: #fff;  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);}/* 2K屏幕优化 */@media (min-width: 2000px) and (max-width: 2600px) {  .hospital-data-view {    max-width: min(1860px, 90vw);  }}/* 超宽屏幕 */@media (min-width: 2600px) {  .hospital-data-view {    max-width: min(2400px, 95vw);  }}/* 搜索区域 - 现在在整合容器内 */.fixed-search {  flex-shrink: 0;  padding: 14px 18px;  background: #ffffff;  border-bottom: 1px solid #ebeef5;  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);  border-radius: 6px 6px 0 0;  max-width: 100%;  box-sizing: border-box;}.search-form {  display: flex;  flex-wrap: wrap;  gap: 12px 8px;  align-items: end;}.search-form :deep(.el-form-item) {  margin-bottom: 0 !important;  flex: 1 1 180px;}.form-actions {  margin-left: 0;  display: flex;  align-items: center;  gap: 10px;  flex: 0 0 auto;}.view-toggle {  margin-left: 16px;}/* 数据内容区域 */.data-content {  flex: 1;  display: flex;  flex-direction: column;  overflow: hidden;}.content-wrapper {  flex: 1;  overflow: hidden;}.table-view {  height: 100%;}.card-view {  height: 100%;  overflow-y: auto;  padding: 16px;}.hospital-card {  height: 100%;  display: flex;  flex-direction: column;  transition: transform 0.2s ease, box-shadow 0.2s ease;}.hospital-card:hover {  transform: translateY(-2px);  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);}.card-header {  display: flex;  justify-content: space-between;  align-items: center;  padding-bottom: 8px;  border-bottom: 1px solid #ebeef5;}.card-title {  font-size: 14px;  font-weight: bold;  max-width: 70%;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;}.card-body {  flex: 1;  margin: 12px 0;}.card-item {  margin-bottom: 8px;  line-height: 1.5;}.card-item .label {  color: #606266;  font-weight: 500;  margin-right: 6px;  min-width: 60px;  display: inline-block;}.card-footer {  margin-top: auto;  text-align: right;  padding-top: 12px;  border-top: 1px solid #f0f0f0;}/* 分页区域 */.fixed-pagination {  flex-shrink: 0;  background: #fafbfc;  padding: 12px;  border-top: 1px solid #ebeef5;  box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.05);  text-align: center;}.pagination-content {  display: inline-flex;  align-items: center;  gap: 16px;}.page-info {  font-size: 12px;  color: #606266;  min-width: 220px;  text-align: center;}.no-data-container {  height: 100%;  display: flex;  align-items: center;  justify-content: center;}.th-content {  position: relative;  text-align: center;  font-weight: 600;}.resize-handle {  position: absolute;  right: 0;  top: 0;  bottom: 0;  width: 4px;  cursor: col-resize;  opacity: 0;  transition: opacity 0.2s;}.th-content:hover .resize-handle {  opacity: 1;  background: #409eff;}/* 详情弹窗样式 */.detail-container {  max-height: 60vh;  overflow-y: auto;  padding-right: 8px;}.detail-row {  display: flex;  margin-bottom: 14px;  align-items: flex-start;}.detail-row label {  min-width: 160px;  font-weight: 600;  color: #303133;  line-height: 1.5;}.detail-row span {  flex: 1;  word-break: break-word;  line-height: 1.5;  color: #606266;}/* 更新弹窗整体 */.update-dialog :deep(.el-dialog) {  display: flex;  flex-direction: column;  max-height: 90vh;  margin: 5vh auto;}/* 自定义标题居中 */.custom-dialog-title {  text-align: center;  font-size: 18px;  font-weight: 600;  width: 100%;  color: #303133;}/* 默认标题隐藏（因为我们用了自定义标题） */.update-dialog :deep(.el-dialog__header) {  padding: 16px 24px;  border-bottom: 1px solid #ebeef5;}/* 顶部固定操作栏 */.dialog-fixed-header {  flex-shrink: 0;  padding: 14px 24px;  background: #fff;  border-bottom: 1px solid #ebeef5;  position: sticky;  top: 0;  z-index: 10;}/* 按钮组靠右对齐 */.header-actions {  display: flex;  justify-content: flex-end;  align-items: center;  flex-wrap: wrap;  gap: 12px;}/* 内容区上下滚动 */.dialog-scroll-body {  flex: 1;  overflow-y: auto;  overflow-x: hidden;  padding: 20px 24px;  box-sizing: border-box;}/* 美化滚动条 */.dialog-scroll-body::-webkit-scrollbar {  width: 8px;}.dialog-scroll-body::-webkit-scrollbar-thumb {  background: #c0c4cc;  border-radius: 4px;}.dialog-scroll-body::-webkit-scrollbar-track {  background: transparent;}.update-dialog :deep(.el-dialog__body) {  flex: 1;  padding: 0;  overflow: hidden;}</style>